CREATE OR REPLACE FUNCTION F_VALIDAREXISTENCIACODIGO(MAIL_IN VARCHAR2, RUN_IN NUMBER) RETURN NUMBER
IS 
	VALIDADOR_EXISTENCIA NUMBER;
BEGIN
	SELECT ID_GESTION INTO VALIDADOR_EXISTENCIA FROM GESTION_OTP WHERE LOWER(MAIL) = LOWER(MAIL_IN) AND UPPER(RUN) = RUN_IN AND ESTADO = 'A';
    IF VALIDADOR_EXISTENCIA>0 THEN
        RETURN VALIDADOR_EXISTENCIA;
    ELSE
        RETURN 0;
    END IF;
EXCEPTION
WHEN NO_DATA_FOUND THEN
    RETURN 0;
END;